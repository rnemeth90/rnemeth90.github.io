<!doctype html><html lang=en><head><title>HTB - Web Application Fuzzing Module - VHost Fuzzing · GeekyRyan</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Ryan Nemeth"><meta name=description content="
  HackTheBox Web Application Fuzzing - VHost Fuzzing
  
    
    Link to heading
  

This is part of a multi-part series documenting my process for completing the HackTheBox modules.
This post covers VHost fuzzing, which allows us to identify sub-domains that do not have public DNS records or sub-domains under websites that are not public.

  Overview
  
    
    Link to heading
  

As we saw in the previous section, we were able to fuzz public sub-domains using public DNS records. However, when it came to fuzzing sub-domains that do not have a public DNS record or sub-domains under websites that are not public, we could not use the same method. This is where VHost fuzzing comes in."><meta name=keywords content="blog,developer,personal,devops"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTB - Web Application Fuzzing Module - VHost Fuzzing"><meta name=twitter:description content="HackTheBox Web Application Fuzzing - VHost Fuzzing Link to heading This is part of a multi-part series documenting my process for completing the HackTheBox modules.
This post covers VHost fuzzing, which allows us to identify sub-domains that do not have public DNS records or sub-domains under websites that are not public.
Overview Link to heading As we saw in the previous section, we were able to fuzz public sub-domains using public DNS records. However, when it came to fuzzing sub-domains that do not have a public DNS record or sub-domains under websites that are not public, we could not use the same method. This is where VHost fuzzing comes in."><meta property="og:url" content="https://rnemeth90.github.io/htb/2025-12-17-htb-ffuf-vhost-fuzzing/"><meta property="og:site_name" content="GeekyRyan"><meta property="og:title" content="HTB - Web Application Fuzzing Module - VHost Fuzzing"><meta property="og:description" content="HackTheBox Web Application Fuzzing - VHost Fuzzing Link to heading This is part of a multi-part series documenting my process for completing the HackTheBox modules.
This post covers VHost fuzzing, which allows us to identify sub-domains that do not have public DNS records or sub-domains under websites that are not public.
Overview Link to heading As we saw in the previous section, we were able to fuzz public sub-domains using public DNS records. However, when it came to fuzzing sub-domains that do not have a public DNS record or sub-domains under websites that are not public, we could not use the same method. This is where VHost fuzzing comes in."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="htb"><meta property="article:published_time" content="2025-12-17T16:01:00+00:00"><meta property="article:modified_time" content="2025-12-17T16:01:00+00:00"><link rel=canonical href=https://rnemeth90.github.io/htb/2025-12-17-htb-ffuf-vhost-fuzzing/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.f8ac2fdd0cb7e56145845d949b5c036d40cd5061c013fd446f2f54a63ade62e8.css integrity="sha256-+Kwv3Qy35WFFhF2Um1wDbUDNUGHAE/1Eby9UpjreYug=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://rnemeth90.github.io/>GeekyRyan
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/til/>TIL</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/notes/>Notes</a></li><li class=navigation-item><a class=navigation-link href=/htb/>HTB</a></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://rnemeth90.github.io/htb/2025-12-17-htb-ffuf-vhost-fuzzing/>HTB - Web Application Fuzzing Module - VHost Fuzzing</a></h1></header><h1 id=hackthebox-web-application-fuzzing---vhost-fuzzing>HackTheBox Web Application Fuzzing - VHost Fuzzing
<a class=heading-link href=#hackthebox-web-application-fuzzing---vhost-fuzzing><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>This is part of a multi-part series documenting my process for completing the HackTheBox modules.</p><p>This post covers VHost fuzzing, which allows us to identify sub-domains that do not have public DNS records or sub-domains under websites that are not public.</p><h2 id=overview>Overview
<a class=heading-link href=#overview><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>As we saw in the previous section, we were able to fuzz public sub-domains using public DNS records. However, when it came to fuzzing sub-domains that do not have a public DNS record or sub-domains under websites that are not public, we could not use the same method. This is where VHost fuzzing comes in.</p><h2 id=vhosts-vs-sub-domains>VHosts vs. Sub-domains
<a class=heading-link href=#vhosts-vs-sub-domains><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>The key difference between VHosts and sub-domains is that a VHost is basically a &lsquo;sub-domain&rsquo; served on the same server and has the same IP, such that a single IP could be serving two or more different websites.</p><p>VHosts may or may not have public DNS records. In many cases, many websites would actually have sub-domains that are not public and will not publish them in public DNS records, and hence if we visit them in a browser, we would fail to connect, as the public DNS would not know their IP. Once again, if we use the sub-domain fuzzing, we would only be able to identify public sub-domains but will not identify any sub-domains that are not public.</p><p>This is where we utilize VHosts Fuzzing on an IP we already have. We will run a scan and test for scans on the same IP, and then we will be able to identify both public and non-public sub-domains and VHosts.</p><h2 id=vhosts-fuzzing>VHosts Fuzzing
<a class=heading-link href=#vhosts-fuzzing><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>To scan for VHosts, without manually adding the entire wordlist to our <code>/etc/hosts</code>, we will be fuzzing HTTP headers, specifically the <code>Host:</code> header. To do that, we can use the <code>-H</code> flag to specify a header and will use the <code>FUZZ</code> keyword within it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H <span class=s1>&#39;Host: FUZZ.academy.htb&#39;</span>
</span></span></code></pre></div><p>We see that all words in the wordlist are returning 200 OK! This is expected, as we are simply changing the header while visiting <code>http://academy.htb:PORT/</code>. So, we know that we will always get 200 OK. However, if the VHost does exist and we send a correct one in the header, we should get a different response size, as in that case, we would be getting the page from that VHosts, which is likely to show a different page.</p><h2 id=filtering-results>Filtering Results
<a class=heading-link href=#filtering-results><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>So far, we have not been using any filtering to our <code>ffuf</code>, and the results are automatically filtered by default by their HTTP code, which filters out code 404 NOT FOUND, and keeps the rest. However, as we saw in our previous run of <code>ffuf</code>, we can get many responses with code 200. So, in this case, we will have to filter the results based on another factor.</p><p>Ffuf provides the option to match or filter out a specific HTTP code, response size, or amount of words. We can see that with <code>ffuf -h</code>.</p><p>In this case, we cannot use matching, as we don&rsquo;t know what the response size from other VHosts would be. We know the response size of the incorrect results, which, as seen from the test above, is 900, and we can filter it out with <code>-fs 900</code>. Now, let&rsquo;s repeat the same previous command, add the above flag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H <span class=s1>&#39;Host: FUZZ.academy.htb&#39;</span> -fs <span class=m>900</span>
</span></span></code></pre></div><p>This will filter out all responses with a size of 900 bytes, leaving only responses with different sizes, which indicate valid VHosts.</p><p>We can verify that by visiting the page and seeing if we can connect to it. We see that we can access the page, but we get an empty page, unlike what we got with <code>academy.htb</code>, therefore confirming this is indeed a different VHost. We can even visit <code>https://admin.academy.htb:PORT/blog/index.php</code>, and we will see that we would get a 404 PAGE NOT FOUND, confirming that we are now indeed on a different VHost.</p><p>Try running a recursive scan on <code>admin.academy.htb</code>, and see what pages you can identify.</p></article></section></div><footer class=footer><section class=container>©
2012 -
2025
Ryan Nemeth
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>